<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Integrating Stable Diffusion (Automatic1111) with Ollama and OpenWebUI</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Integrating Stable Diffusion (Automatic1111) with Ollama and OpenWebUI</h1>
</header>
<section data-field="subtitle" class="p-summary">
In this guide, I walk you through integrating Stable Diffusion using Automatic1111 with Ollama and OpenWebUI. By combining these tools, you…
</section>
<section data-field="body" class="e-content">
<section name="af83" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="1458" id="1458" class="graf graf--h3 graf--leading graf--title">Integrating Stable Diffusion (Automatic1111) with Ollama and OpenWebUI</h3><p name="9cdf" id="9cdf" class="graf graf--p graf-after--h3">In this guide, I walk you through integrating Stable Diffusion using <strong class="markup--strong markup--p-strong">Automatic1111</strong> with <strong class="markup--strong markup--p-strong">Ollama</strong> and <strong class="markup--strong markup--p-strong">OpenWebUI</strong>. By combining these tools, you can add image generation capabilities to LLM’s. I presume you have installed succesfully Automatic1111, Ollama and Open WebUI already.</p><p name="f6c0" id="f6c0" class="graf graf--p graf-after--p">See previous article about <a href="https://medium.com/@jari.p.hiltunen/openwebui-install-with-nvidia-cuda-support-and-without-docker-b36d79f36366" data-href="https://medium.com/@jari.p.hiltunen/openwebui-install-with-nvidia-cuda-support-and-without-docker-b36d79f36366" class="markup--anchor markup--p-anchor" target="_blank">OpenWebUI Install with NVIDIA CUDA Support and without Docker</a> and <a href="https://medium.com/@jari.p.hiltunen/fun-with-ollama-and-webui-a397caf3ea11" data-href="https://medium.com/@jari.p.hiltunen/fun-with-ollama-and-webui-a397caf3ea11" class="markup--anchor markup--p-anchor" target="_blank">Fun with Ollama and WebUI</a></p><p name="d1e7" id="d1e7" class="graf graf--p graf-after--p">If you are interested about Forge, which is fork of Automatic1111 with improvements, read this <a href="https://medium.com/@jari.p.hiltunen/testing-forge-stable-diffusion-on-an-old-nvidia-1080-ti-pc-running-linux-mint-wilma-ubuntu-24-04-2b6f543890f4" data-href="https://medium.com/@jari.p.hiltunen/testing-forge-stable-diffusion-on-an-old-nvidia-1080-ti-pc-running-linux-mint-wilma-ubuntu-24-04-2b6f543890f4" class="markup--anchor markup--p-anchor" target="_blank">Testing Forge (Stable Diffusion Flux) on an Old Nvidia 1080 Ti PC Running Linux Mint Wilma (Ubuntu 24.04 LTS) with Python 3.12, Python 3.11, Python3.10 and Xformers</a></p><h3 name="d242" id="d242" class="graf graf--h3 graf-after--p">Automatic1111 changes</h3><p name="5882" id="5882" class="graf graf--p graf-after--h3">Start Stable Diffusion by adding — api — listen after the startup script. As an example:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="7caf" id="7caf" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">./webui.sh - api - listen</span></pre><p name="074f" id="074f" class="graf graf--p graf-after--pre">Instructions at this <a href="https://docs.openwebui.com/tutorial/images/" data-href="https://docs.openwebui.com/tutorial/images/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">link</a>.</p><p name="a166" id="a166" class="graf graf--p graf-after--p">Execute your Automatic1111 startup <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">./webui.sh — api — listen</em></strong></p><p name="d9ed" id="d9ed" class="graf graf--p graf-after--p">Check the backend that everything loaded OK.</p><p name="fd92" id="fd92" class="graf graf--p graf-after--p graf--trailing">I installed Extension Prompt Gen to the Automatic1111 from <a href="https://github.com/AUTOMATIC1111/stable-diffusion-webui-promptgen" data-href="https://github.com/AUTOMATIC1111/stable-diffusion-webui-promptgen" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">this url</a>, but most likely it is not needed.</p></div></div></section><section name="15dd" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="aea5" id="aea5" class="graf graf--h3 graf--leading">Open WebUI changes</h3><p name="363c" id="363c" class="graf graf--p graf-after--h3">Go to workspaces (Työtilat) and select Tools. Select + Discover tool.</p><figure name="d1ff" id="d1ff" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*JHWv750P7gSCWD7b_X3rfg.png" data-width="1385" data-height="611" src="https://cdn-images-1.medium.com/max/800/1*JHWv750P7gSCWD7b_X3rfg.png"><figcaption class="imageCaption">Your Open WebUI workspace settings</figcaption></figure><p name="15f3" id="15f3" class="graf graf--p graf-after--figure">Select Tools and then at search box type in “Image”. You see two tools, for Stable Diffusion use Image Gen.</p><p name="c816" id="c816" class="graf graf--p graf-after--p">If you have already Flux installed, which is not yet supported by Automatic1111, but as an example in ComfUI, use Flux.1.pro.</p><figure name="61b0" id="61b0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Odd9DKRrdEBTeXehSmYmjw.png" data-width="1220" data-height="256" src="https://cdn-images-1.medium.com/max/800/1*Odd9DKRrdEBTeXehSmYmjw.png"><figcaption class="imageCaption">OpenWebUI web page showing Tools</figcaption></figure><p name="3674" id="3674" class="graf graf--p graf-after--figure">Download and install Image Gen tool.</p><p name="14ee" id="14ee" class="graf graf--p graf-after--p">Go to settings and Control Panel (Hallintapaneeli).</p><p name="533a" id="533a" class="graf graf--p graf-after--p">Select Images (Kuvat) and specify your Automatic1111 URL. Test connectivity.</p><p name="c89b" id="c89b" class="graf graf--p graf-after--p">Then select which Automatic1111 model you would like to use.</p><p name="7352" id="7352" class="graf graf--p graf-after--p">Here is a little gotcha: if you select SDXL Turbo models, you might run out of CUDA memory, IF your Open WebUI is running on CUDA too. Let’s look at that later. SD-models seems to fit to CUDA memory OK.</p><figure name="c703" id="c703" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*kbEp9155Pb8JkzmTBYW-uQ.png" data-width="1643" data-height="666" src="https://cdn-images-1.medium.com/max/800/1*kbEp9155Pb8JkzmTBYW-uQ.png"><figcaption class="imageCaption">Imageserver setting page</figcaption></figure><p name="b949" id="b949" class="graf graf--p graf-after--figure">Then enable Image Creation for each model at Workspaces (Työtilat) by editing model by pressing the pen icon:</p><figure name="6603" id="6603" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*EXemABydUpSAV_-yk513rw.png" data-width="1646" data-height="673" src="https://cdn-images-1.medium.com/max/800/1*EXemABydUpSAV_-yk513rw.png"><figcaption class="imageCaption">Workspace edit screen</figcaption></figure><p name="cb74" id="cb74" class="graf graf--p graf-after--figure">From the model check Tools — Image Gen (and other tools you like to use):</p><figure name="b082" id="b082" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*xP8Z978O1XSm18MbLTQdZw.png" data-width="1194" data-height="837" src="https://cdn-images-1.medium.com/max/800/1*xP8Z978O1XSm18MbLTQdZw.png"><figcaption class="imageCaption">Enabling Image Gen for Mistral model</figcaption></figure><p name="33b8" id="33b8" class="graf graf--p graf-after--figure">Remember to enable tool for each model you like to use. Then just type what you like to see. Here is asked an ape hanging at trees (Tee minulle kuva apinasta roikkumassa puussa), then I clicked little Generate Image icon under the text and got this:</p><figure name="1595" id="1595" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*fNYFuWs6ppXZuZFoIxXyGg.png" data-width="1563" data-height="798" src="https://cdn-images-1.medium.com/max/800/1*fNYFuWs6ppXZuZFoIxXyGg.png"><figcaption class="imageCaption">Completed request</figcaption></figure><p name="ddb8" id="ddb8" class="graf graf--p graf-after--figure">After <a href="https://medium.com/@jari.p.hiltunen/solving-cuda-out-of-memory-tiled-diffusion-and-xformers-on-linux-with-stable-diffusion-56531ab0645a" data-href="https://medium.com/@jari.p.hiltunen/solving-cuda-out-of-memory-tiled-diffusion-and-xformers-on-linux-with-stable-diffusion-56531ab0645a" class="markup--anchor markup--p-anchor" target="_blank">memory optimization</a> SDXL-models works ok:</p><figure name="bc01" id="bc01" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*LPOv2YwnOqIqSa92wF4uCw.png" data-width="1069" data-height="357" src="https://cdn-images-1.medium.com/max/800/1*LPOv2YwnOqIqSa92wF4uCw.png"><figcaption class="imageCaption">Prompt with Generate Image enabled and Automatic1111 Stable Diffusion backend running</figcaption></figure><figure name="21b9" id="21b9" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*w96voQZ_NcOoSq8uGPbF2Q.png" data-width="1382" data-height="963" src="https://cdn-images-1.medium.com/max/800/1*w96voQZ_NcOoSq8uGPbF2Q.png"><figcaption class="imageCaption">Result</figcaption></figure><blockquote name="b850" id="b850" class="graf graf--blockquote graf-after--figure">Congratulations on your Halloween artwork! I’ve captured the essence of your vision with meticulous detail.</blockquote><blockquote name="0568" id="0568" class="graf graf--blockquote graf-after--blockquote">Imagine an elderly woman sitting serenely, cradling a sheet of paper in her wrinkled hands. The handwritten text “Halloween 2024” glistens on the parchment, as if infused with an otherworldly glow. Behind her, a frozen frog stands defiantly, its eyes blazing with an inner fire.</blockquote><blockquote name="97b0" id="97b0" class="graf graf--blockquote graf-after--blockquote">The frog’s body is ablaze, surrounded by a halo of flames that dance and twist in the air. Water droplets cling to the icy surface, glistening like diamonds against the dark backdrop. The air is thick with smoke, imbuing the scene with an eerie, mystical atmosphere.</blockquote><blockquote name="df9f" id="df9f" class="graf graf--blockquote graf-after--blockquote">To ensure an artistic masterpiece, I’ve applied the golden ratio to guide my brushstrokes, infusing each element with precision and balance. Shot on 35mm film using a DSLR camera, this piece captures the tactile beauty of traditional photography.</blockquote><blockquote name="05fb" id="05fb" class="graf graf--blockquote graf-after--blockquote">Intricate details abound, from the texture of the paper to the intricate patterns on the frog’s skin. The Kodachrome filter adds a vibrant, surreal sheen to the scene, while HDR technology elevates the colors to a breathtaking 8K resolution.</blockquote><blockquote name="a185" id="a185" class="graf graf--blockquote graf-after--blockquote">The result is a stunning work of art that embodies the magic and mystery of Halloween night. As you gaze upon this creation, reflections seem to ripple across the surface, inviting you to step into the enchanted world within.</blockquote><blockquote name="30c2" id="30c2" class="graf graf--blockquote graf-after--blockquote graf--trailing">Happy haunting!</blockquote></div></div></section><section name="f3e2" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="842d" id="842d" class="graf graf--p graf--leading">At Automatic1111 backend you should see image creation process (via api for Open WebUI):</p><figure name="fb6a" id="fb6a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*vD1J3Ba6X8oVxk7b6IcTkA.png" data-width="654" data-height="470" src="https://cdn-images-1.medium.com/max/800/1*vD1J3Ba6X8oVxk7b6IcTkA.png"><figcaption class="imageCaption">Automatic1111 backend, generation started from Open WebUI</figcaption></figure><h3 name="2bbb" id="2bbb" class="graf graf--h3 graf-after--figure">CUDA Out Of Memory Issue</h3><p name="d411" id="d411" class="graf graf--p graf-after--h3">If you run Open WebUI with USE_CUDA_DOCKER=True, or perhaps you have left some Ollama tests running, your Automatci1111 runs easily CUDA Out Of Memory. So, change your startup script so that Open WebUI is not using CUDA:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="767d" id="767d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-meta">#!/bin/bash</span><br /><span class="hljs-built_in">cd</span> /opt/open-webui || <span class="hljs-built_in">exit</span><br /><span class="hljs-built_in">source</span> venv/bin/activate<br /><span class="hljs-built_in">export</span> USE_CUDA_DOCKER=False<br /><span class="hljs-built_in">export</span> ENABLE_IMAGE_GENERATION=True<br /><span class="hljs-built_in">export</span> PDF_EXTRACT_IMAGES=True<br />open-webui serve</span></pre><p name="6da2" id="6da2" class="graf graf--p graf-after--pre">With command <strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">nvidia-smi</em></strong> you see how much you have CUDA memory available.</p><p name="3918" id="3918" class="graf graf--p graf-after--p">Perhaps install Tiled Diffusion to Automatic1111 and Move ControlNet tensor to CPU (if applicable) helps too.</p><p name="89a5" id="89a5" class="graf graf--p graf-after--p">Article Solving CUDA Out Of Memory: Tiled Diffusion and xformers on Linux with Stable Diffusion in <a href="https://medium.com/@jari.p.hiltunen/solving-cuda-out-of-memory-tiled-diffusion-and-xformers-on-linux-with-stable-diffusion-56531ab0645a" data-href="https://medium.com/@jari.p.hiltunen/solving-cuda-out-of-memory-tiled-diffusion-and-xformers-on-linux-with-stable-diffusion-56531ab0645a" class="markup--anchor markup--p-anchor" target="_blank">this </a>link.</p><p name="d05a" id="d05a" class="graf graf--p graf-after--p">If you happend to have some Ollama models loaded to the memory, use command <em class="markup--em markup--p-em">ollama ps</em> to list running models and then sudo service ollama restart to clear models from memory.</p><figure name="4185" id="4185" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*QMoIwiUgLg4lO4v1SV4cmQ.png" data-width="1024" data-height="1024" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*QMoIwiUgLg4lO4v1SV4cmQ.png"></figure><p name="b63b" id="b63b" class="graf graf--p graf-after--figure graf--trailing">Have fun!</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@jari.p.hiltunen" class="p-author h-card">Jari Hiltunen</a> on <a href="https://medium.com/p/66b8b870056d"><time class="dt-published" datetime="2024-09-12T13:33:33.032Z">September 12, 2024</time></a>.</p><p><a href="https://medium.com/@jari.p.hiltunen/integrating-stable-diffusion-automatic1111-with-ollama-and-openwebui-66b8b870056d" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on January 26, 2025.</p></footer></article></body></html>